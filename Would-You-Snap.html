<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Would You Snap? (Infinite)</title>
<style>
  body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: #f0f0f5;
    color: #222;
    max-width: 600px;
    margin: 40px auto;
    padding: 20px;
    border-radius: 10px;
    box-shadow: 0 0 10px #aaa;
  }
  h1 {
    text-align: center;
    margin-bottom: 10px;
  }
  #scenario {
    font-size: 1.2em;
    margin-bottom: 20px;
    min-height: 60px;
  }
  button {
    display: block;
    width: 100%;
    margin: 8px 0;
    padding: 12px;
    font-size: 1em;
    border-radius: 6px;
    border: none;
    cursor: pointer;
  }
  button:hover {
    background-color: #ddd;
  }
  #rageMeterContainer {
    background: #ccc;
    border-radius: 8px;
    margin: 25px 0;
    height: 25px;
    width: 100%;
    overflow: hidden;
  }
  #rageMeter {
    background: #e74c3c;
    width: 0%;
    height: 100%;
    transition: width 0.5s ease;
  }
  #result {
    font-weight: bold;
    font-size: 1.3em;
    text-align: center;
    margin-top: 25px;
  }
  #restartBtn {
    display: none;
    margin-top: 15px;
    background-color: #3498db;
    color: white;
  }
</style>
</head>
<body>

<h1>Would You Snap? (Infinite)</h1>

<div id="scenario"></div>

<div id="choices"></div>

<div id="rageMeterContainer">
  <div id="rageMeter"></div>
</div>

<div id="result"></div>
<button id="restartBtn">Reset Rage</button>

<script>
  // Base template parts to generate random scenarios
  const scenarioSubjects = [
    "Someone is loudly", "Your friend is", "Your phone is",
    "A coworker", "Your neighbor", "The driver behind you is",
    "Your sibling", "Your boss", "The waiter"
  ];

  const scenarioActions = [
    "chewing gum right next to you",
    "late without telling you",
    "autocorrecting everything wrong",
    "taking the last coffee without making more",
    "playing loud music late at night",
    "tailgating your car aggressively",
    "borrowing your stuff without asking",
    "giving you extra work at the last minute",
    "forgetting your order at the restaurant"
  ];

  // Possible choices templates with rage changes
  const choiceTemplates = [
    {text: "Stay calm, ignore it.", rageChange: 0},
    {text: "Feel a little annoyed.", rageChange: 15},
    {text: "Snap and yell about it!", rageChange: 45}
  ];

  let rage = 0;         // player's rage meter value (0-100)

  const scenarioEl = document.getElementById('scenario');
  const choicesEl = document.getElementById('choices');
  const rageMeterEl = document.getElementById('rageMeter');
  const resultEl = document.getElementById('result');
  const restartBtn = document.getElementById('restartBtn');

  // Generate a random scenario object with text and choices
  function generateScenario() {
    // Pick random subject and action (avoid mismatch)
    const subj = scenarioSubjects[Math.floor(Math.random() * scenarioSubjects.length)];
    const act = scenarioActions[Math.floor(Math.random() * scenarioActions.length)];

    const text = `${subj} ${act}.`;

    // Clone choiceTemplates and slightly randomize rageChange a bit
    const choices = choiceTemplates.map(choice => ({
      text: choice.text,
      rageChange: choice.rageChange + (Math.floor(Math.random() * 10) - 5) // Â±5 variance
    }));

    return { text, choices };
  }

  // Show a scenario and choices
  function updateScenario() {
    const scenario = generateScenario();
    scenarioEl.textContent = scenario.text;
    choicesEl.innerHTML = '';
    resultEl.textContent = '';

    scenario.choices.forEach(choice => {
      const btn = document.createElement('button');
      btn.textContent = choice.text;
      btn.onclick = () => {
        let rageChange = choice.rageChange;

        // Add 30% chance of small rage if ignoring (rageChange == ~0)
        if (rageChange <= 5 && Math.random() < 0.3) {
          rageChange = 10;
        }

        rage += rageChange;
        if (rage > 100) rage = 100;
        if (rage < 0) rage = 0;

        updateRageMeter();
        checkRageLevel();
        updateScenario();
      };
      choicesEl.appendChild(btn);
    });
  }

  // Update rage meter bar width
  function updateRageMeter() {
    rageMeterEl.style.width = rage + '%';
    // Optional: change color based on rage level
    if (rage < 40) {
      rageMeterEl.style.backgroundColor = '#27ae60'; // green
    } else if (rage < 75) {
      rageMeterEl.style.backgroundColor = '#f39c12'; // orange
    } else {
      rageMeterEl.style.backgroundColor = '#e74c3c'; // red
    }
  }

  // Show message if rage is maxed out
  function checkRageLevel() {
    if (rage >= 100) {
      resultEl.textContent = `You snapped completely! Rage level: 100%. Take a deep breath...`;
      // Optionally disable choices temporarily or force reset
      choicesEl.innerHTML = '';
    } else if (rage >= 75) {
      resultEl.textContent = `Warning! Rage is high: ${rage}%. Try to calm down!`;
    } else {
      resultEl.textContent = '';
    }
  }

  // Restart rage to zero but keep game going
  restartBtn.onclick = () => {
    rage = 0;
    updateRageMeter();
    resultEl.textContent = '';
    updateScenario();
  };

  // Initialize on page load
  updateRageMeter();
  updateScenario();
  restartBtn.style.display = 'block';
</script>

</body>
</html>
